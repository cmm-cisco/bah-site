<!DOCTYPE html>
<!-- saved from url=(0042)http://opflex.ciscolive.com/pod1/basics/os -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta http-equiv="cache-control" content="max-age=0">
            <meta http-equiv="cache-control" content="no-cache">
            <meta http-equiv="expires" content="0">
            <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">
            <meta http-equiv="pragma" content="no-cache">
            <link href="./os_files/bootstrap.min.css" rel="stylesheet" media="screen">
            <link href="./os_files/github.css" rel="stylesheet">
            <link href="./os_files/cerulean.css" rel="stylesheet">
            <link href="./os_files/whitebackgroundmenu.css" rel="stylesheet">
            <link rel="stylesheet" href="./os_files/font-awesome.min.css">
            <link href="./os_files/style.css" rel="stylesheet">
            <link href="./os_files/cssterm.css" rel="stylesheet">
            <link href="./os_files/bootstrap-select.min.css" rel="stylesheet">

<title>BAH Module 3</title>
 <meta name="author" content="Omar Santos">

</head>
<body>


	<div class="container">
		<nav class="navbar navbar-default navbar-fixed-top" id="ltraci-navbar" role="navigation">
		  <div class="container-fluid">
		    <!-- Brand and toggle get grouped for better mobile display -->
		    <div class="navbar-header">

			        <a href="index.html" class="navbar-brand"><div class="pn-noncollapse">Becoming a Hacker</div></a>

		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar navbar-inverse"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		    </div>
		    <!-- Collect the nav links, forms, and other content for toggling -->
		    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		      <ul class="nav navbar-nav">


		        <li class="dropdown">
		          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Menu<span class="caret"></span></a>
		          <ul class="dropdown-menu multi-column columns-3" role="menu" style="font-size:.7em;">
			          <div class="row">
				          <div class="col-sm-3">
					          <ul class="multi-column-dropdown">
										<li class="dropdown-header">Module 1</li>
										  <li>
                       <a href="#">No labs</a>
                      </li>
                    </ul>
				          </div>

                  <div class="col-sm-3">
					          <ul class="multi-column-dropdown">
										<li class="dropdown-header">Module 2</li>
										  <li>
                       <a href="module2.html">Passive Reconnissaince</a>
                      </li>
                    </ul>
				          </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 3</li>
                      <li>
                       <a href="module3.html">Active Reconnissaince</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 4</li>
                      <li>
                       <a href="module4.html">Networking</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 5</li>
                      <li>
                       <a href="module5.html">Wireless</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 6</li>
                      <li>
                       <a href="module6.html">Web Applications</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 7</li>
                      <li>
                       <a href="module7.html">Accounts and Passwords</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
					          <ul class="multi-column-dropdown">
										<li class="dropdown-header">Module 8</li>
										  <li>
                       <a href="module8.html">Overflows</a>
                      </li>
                    </ul>
				          </div>


               </div>
               </ul>
               </li>



				<li class="ciscoliveitem"><a target="blank" href="resources.html">Resources</a></li>
				<li class="ciscoliveitem"><a target="blank" data-toggle="modal" data-target="#ABOUT" href="#">About</a></li>

		      </ul>

		    </div><!-- /.navbar-collapse  width="30px" -->
		  </div><!-- /.container-fluid -->
		</nav>
		</div>


    <div class="modal fade" id="ABOUT" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
            <h3 class="modal-title" id="myModalLabel">Becoming a Hacker Training</h3>
          </div>
          <div class="modal-body">
    		<div class="row">
                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
                    <img src="./os_files/hacker.png" class="img-responsive">
                </div>
                <div class="col-lg-8 col-md-8 col-sm-6 col-xs-12">
                    <p>
                        The purpose of this lab is to provide the student a better understanding of offensive security.
                    </p>
                    <p>
                        Navigate to the <a href="resources.html"> Resources </a> page to obtain the presentations used in this class, as well as other resources on how to build your own lab.
                    </p>
                </div>
            </div>
            <div class="row">
              <p>

              </p>
            </div>
    		<div class="row" style="margin-top:20px;">
    			<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
    				<strong>Chris McCoy</strong><br>
                    Hacker, ASIG<br>
    				cmm@cisco.com<br>
    			</div>
    			<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
    				<strong>Everett Stiles</strong><br>
                    Hacker, ASIG<br>
    				estiles@cisco.com<br>
    			</div>
    			<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
    				<strong>Omar Ωr Santos</strong><br>
                    Peasant, PSIRT<br>
    				os@cisco.com<br>
    			</div>
    		</div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

		<!-- <div class="container"> -->
			<!-- <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"> -->



<div class="container">
<h1>Active Reconnaissance</h1>
    <p>You need to figure out the network topology in your own (as part of this exercise/module). However, the following are the instructions on how to connect to the lab:</p>

<img src="os_files/topology.png" width="80%" height="80%">
<hr>
<pre>
  Kali Username: root    Password: seccon!
</pre>
<p> <strong>Note:</strong> If you would like to use SSH, you can connect to your pod using port 22XX (XX = your pod number)
</p>
<pre>
   ssh -p 2217 root@labs.becomingahacker.com
</pre>
<hr>
<h2> Exercise 1: Using NMAP </h2>

<p>Open a terminal session in your Kali box and type <strong>nmap</strong>.</p>


<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Nmap Options</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 1 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-1">Copy</button></div>
<div class="ciscohl2" id="copy-1" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
<pre>
nmap -h
</pre>
</div></div>
<!-- end of copy /paste block -->


<h3>Task 1</h3>
Using nmap try to learn the hosts that are active in your network and all the "victims" you can find
Constrain your search to 192.168.1.0/24 and 192.168.2.0/24

<h3>Task 2</h3>
<p>Once you find all the active hosts, try to find all the open TCP and UDP ports on those machines.</p>
<p>nmap doesn't scan all ports by default. It limits itself to 1000 or so common ports. Figure out how to override this.<p>
<p>UDP takes a &nbsp;<strong>long</strong>&nbsp;time. You might defer that scan for later.</p>

<h3>Task 3</h3>
Add Server Version checks (-sV) to gain more information.</p>


<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Nmap Server Version Checks</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 2 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-2">Copy</button></div>
<div class="ciscohl2" id="copy-2" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
<pre>
nmap -sV &lt;victim IP&gt;
</pre>
</div></div>
<!-- end of copy /paste block -->
<a href="https://github.com/The-Art-of-Hacking/h4cker/blob/master/cheat_sheets/NMAP_cheat_sheet.md">Click here for some hints</a>
<hr>

<h2>Exercise 2 : Add NMAP Results to Metasploit Database</h2>

<h3>Task 1</h3>
Start the postgresql service:
<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Starting postgresql</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 3 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-3">Copy</button></div>
<div class="ciscohl2" id="copy-3" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
  <pre>
systemctl start postgresql.service
  </pre>
  </div></div>
  <!-- end of copy /paste block -->

<h3>Task 2</h3>
Initialize the msf database:

<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Initializing the msf Database</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 4 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-4">Copy</button></div>
<div class="ciscohl2" id="copy-4" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
  <pre>
msfdb init
  </pre>
  </div></div>
  <!-- end of copy /paste block -->


<h3>Task 2</h3>
<p>Using&nbsp;<tt>msfconsole</tt>. Make sure the database is connected. What other&nbsp;<strong>database backend commands</strong>&nbsp;exist? Try&nbsp;<tt>help</tt></p>

<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Metasploit Console</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 5 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-5">Copy</button></div>
<div class="ciscohl2" id="copy-5" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
  <pre>
msfconsole
  </pre>
  </div></div>
  <!-- end of copy /paste block -->


<pre>
# <strong>msfconsole </strong>
...
       =[ metasploit v4.9.2-2014042301 [core:4.9 api:1.0] ]
+ -- --=[ 1301 exploits - 778 auxiliary - 220 post ]
+ -- --=[ 335 payloads - 35 encoders - 8 nops      ]

msf > <strong>db_[TAB][TAB]</strong>
db_connect        db_export         db_nmap           db_status
db_disconnect     db_import         db_rebuild_cache

</pre>

<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>DB Status</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 6 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-6">Copy</button></div>
<div class="ciscohl2" id="copy-6" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
  <pre>
db_status
  </pre>
  </div></div>
  <!-- end of copy /paste block -->
<pre>
msf > db_status
[*] postgresql connected to msf
msf >
</pre>



<h3>Task 4</h3>
<p>Using&nbsp;<tt>db_nmap</tt>&nbsp;instead of&nbsp;<tt>nmap</tt>, run the same commands you ran in Exercise 1 to load information into the database. This information will stay persistent for successive modules. You should be able to run the&nbsp;<tt>services</tt>&nbsp;command and see the services found by nmap at anytime without scanning again.</p>

<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
  <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Using db_nmap</div>
  <div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 7 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-7">Copy</button></div>
<div class="ciscohl2" id="copy-7" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
  <!-- put the code here -->
  <pre>
db_nmap 192.168.1.0/24
</pre>
  </div></div>
  <!-- end of copy /paste block -->

<pre>
  msf > services

  Services
  ========

  host         port   proto  name           state  info
  ----         ----   -----  ----           -----  ----
  192.168.1.2  22     tcp    ssh            open   OpenSSH 6.0p1 Debian 4+deb7u1 protocol 2.0
  192.168.1.2  3790   tcp    http           open   nginx
  192.168.1.2  5800   tcp    vnc-http       open   x11vnc
  192.168.1.2  5900   tcp    vnc            open   VNC protocol 3.7
  192.168.1.3  21     tcp    ftp            open   vsftpd 2.3.4
  192.168.1.3  22     tcp    ssh            open   OpenSSH 4.7p1 Debian 8ubuntu1 protocol 2.0
  192.168.1.3  23     tcp    telnet         open   Linux telnetd
  192.168.1.3  25     tcp    smtp           open   Postfix smtpd
  192.168.1.3  53     tcp    domain         open   ISC BIND 9.4.2
  ...
</pre>


<h2>Exercise 3 : Using Wireshark</h2>
<h3>Task 1</h3>
Open Wireshark and listen to the eth1 network interface. What protocols are present?

<pre>
  You may only see BROADCAST traffic but it may be informative.
  Filter for:
   * arp
   * netbios
   * rip
   * udp.port != 1985
   * etc..
</pre>

<h2>Exercise 4 : DNS Reconnaissance</h2>
<h3>Task 1</h3>
<p>Do a&nbsp;<a class="http" href="http://en.wikipedia.org/wiki/DNS_zone_transfer">zone transfer</a>&nbsp;of&nbsp;<strong><tt>seccon.ninja</tt></strong>&nbsp;domain using the&nbsp;<tt>dig</tt>&nbsp;(<a class="https" href="https://www.madboa.com/geek/dig/">domain information groper</a>) tool</p>

If the domain you want to query allows DNS zone transfers, you can get those, too. The reality of life on the Internet, however, is that very few domains allow unrestricted transfers these days, and limit zone transfers to secondary name server IPs. You'll learn how to bypass IP access control lists later in the course.

  <!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
  <div class="topbar">
    <div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Using dig</div>
    <div class="topbarbutton"></div> </div>
  <div class="commandblock"> <div class="copyseqnumber"> 9 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-9">Copy</button></div>
  <div class="ciscohl2" id="copy-9" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
    <!-- put the code here -->
    <pre>
dig seccon.ninja NS<br>
dig seccon.ninja AXFR
    </pre>
    </div></div>
    <!-- end of copy /paste block -->





























<div class="nextsection">
    <div style="float:left; font-size: .9em;">

    </div>
    <div style="float:right; font-size: .9em;">

            <div class="btn-group">
                <button type="button" class="btn btn-md btn-success" onclick="window.location.href=&#39;module4.html&#39;">Next: Module 4</button>
                <button type="button" class="btn btn-md btn-success" onclick="window.location.href=&#39;/module4.html&#39;">
                        <span class="glyphicon glyphicon-chevron-right" style="color:white;" aria-hidden="true"></span>
                </button>
            </div>

    </div>
</div>

</div><!-- Whole page container -->

			<!-- </div> -->
    	<!--- </div> -->
        <span style="font-size:.7em; color:0x696969; float:right;margin:30px 20px 0px 0px;">© Copyright Cisco Systems</span>



<script src="./os_files/jquery.min.js"></script>
<script src="./os_files/bootstrap.min.js"></script>
<!-- <script src="/static/js/ZeroClipboard.js" type="text/javascript"></script> -->
<script src="./os_files/highlight.pack.js"></script>
<script type="text/javascript" src="./os_files/sijax.js"></script>
<script type="text/javascript" src="./os_files/cssterm.js"></script>
<script type="text/javascript" src="./os_files/clipboard.min.js"></script>
<script type="text/javascript" src="./os_files/bootstrap-select.min.js"></script>
<script type="text/javascript">
    Sijax.setRequestUri("/pod1/basics/os");Sijax.setJsonUri("/static/js/sijax/json2.js");
</script>


<script type="text/javascript">
var urlParams;
(window.onpopstate = function () {
    var match,
        pl     = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
        query  = window.location.search.substring(1);

    urlParams = {};
    while (match = search.exec(query))
       urlParams[decode(match[1])] = decode(match[2]);
})();

// Config ZeroClipboard
//ZeroClipboard.config({
//    hoverClass: 'btn-clipboard-hover'
//})

// Insert copy to clipboard button before .ciscohl
//$('.ciscohl').each(function () {
//    var btnHtml = '<div class="zero-clipboard"><span class="btn-clipboard">Copy</span></div>';
//    $(this).before(btnHtml)
//});

function runit(codeid){
    var codeblock = "codeblock-" + codeid;
    var preblock =  "output-" + codeid;
    var outfixhtmlfunc = 'outputfixhtml' + codeid;
    var code = document.getElementById(codeblock).value;
	document.getElementById(preblock).innerHTML = '';
    Sk.configure({output:eval(outfixhtmlfunc) });
    eval(Sk.importMainWithBody("<stdin>", false, code));
}





//var zeroClipboard = new ZeroClipboard($('.btn-clipboard'));
//var htmlBridge = $('#global-zeroclipboard-html-bridge');
//
//// Handlers for ZeroClipboard
//zeroClipboard.on('ready', function (event) {
//    htmlBridge
//        .data('placement', 'top')
//        .attr('title', 'Copy to clipboard')
//        .tooltip();
//    var ciscohl = $(event.target).parent().nextAll('.ciscohl').first();
//    console.log(ciscohl);
//
//    // Copy to clipboard
//    zeroClipboard.on('copy', function (event) {
//        var ciscohl = $(event.target).parent().nextAll('.ciscohl').first();
//        console.log ( ciscohl[0].id );
//        var pod = urlParams["pod"];
//        var section = urlParams["section"];
//
//        $.ajax({
//	       //type: "GET",
//	       url: "/dash/collect/pod/1/basics/os/" + ciscohl[0].id
//	       // data:  "pod=" + pod + "&section=" + section + "&step=" + ciscohl[0].id
//        });
//        event.clipboardData.setData("text/plain", ciscohl.text());
//         // $(event.target).parent().next(".ciscohl").css("background","#e0ffcb url('/static/images/ok.png') no-repeat top left / 45px 45px")
//         $(event.target).parent().next(".ciscohl").css("background","#e0ffcb url('/static/images/ok.png') no-repeat bottom right / 45px 45px")
//    });
//
//    // Notify copy success and reset tooltip title
//    zeroClipboard.on('aftercopy', function () {
//        htmlBridge
//            .attr('title', 'Copied!')
//            .tooltip('fixTitle')
//            .tooltip('show')
//            .attr('title', 'Copy to clipboard')
//            .tooltip('fixTitle');
//
//    });
//});
//
//function findPos(obj) {
//    var curtop = 0;
//    if (obj.offsetParent) {
//        do {
//            curtop += obj.offsetTop;
//        } while (obj = obj.offsetParent);
//    return [curtop];
//    }
//}
//
//
//// Notify copy failure
//zeroClipboard.on('error', function () {
//    ZeroClipboard.destroy();
//    htmlBridge
//        .attr('title', 'Flash required')
//        .tooltip('fixTitle')
//        .tooltip('show');
//});
//

///////////////////////////////////////////////////////////////////////////////
// Start NEW COPY/PASTE Clipboard code.
///////////////////////////////////////////////////////////////////////////////

var clipboard = new Clipboard('.copybutton', {
    text: function(btn_object){
        var webcopy = $(btn_object).parent().nextAll('.ciscohl2').first();
        return webcopy[0].innerText + "\n\r";
    }
});
clipboard.on('success', function(e) {
    var webcopy = $(event.target).parent().nextAll('.ciscohl2').first();
    var pod = urlParams["pod"];
    var section = urlParams["section"];

    $.ajax({
        url: "/dash/collect/pod/1/basics/os/" + webcopy[0].id
    });
    $(event.target).parent().next(".ciscohl2").css("background","#e0ffcb url('/static/images/ok.png') no-repeat bottom right / 45px 45px")

    e.clearSelection();
});
///////////////////////////////////////////////////////////////////////////////
// End COPY/PASTE Clipboard code.
///////////////////////////////////////////////////////////////////////////////



$(document).ready(function(){
   // cache the window object
   $window = $(window);

    $('.selectpicker').selectpicker({
          style: 'btn-default',
          size: 12
      });






    // $('pre code').each(function(i, block) {
    //     hljs.highlightBlock(block);
    // });

   $('section[data-type="background"]').each(function(){
     // declare the variable to affect the defined data-type
     var $scroll = $(this);

      $(window).scroll(function() {
        // HTML5 proves useful for helping with creating JS functions!
        // also, negative value because we're scrolling upwards
        var yPos = -($window.scrollTop() / $scroll.data('speed'));

        // background position
        var coords = '50% '+ yPos + 'px';

        // move the background
        $scroll.css({ backgroundPosition: coords });
      }); // end window scroll
   });  // end section function
}); // close out script


</script>

<textarea readonly="" style="font-size: 12pt; border: 0px; padding: 0px; margin: 0px; position: absolute; left: -9999px; top: 0px;"></textarea></body></html>
